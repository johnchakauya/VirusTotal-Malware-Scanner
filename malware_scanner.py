import virustotal #Importing the VirusTotal API module

scanner = virustotal.VirusTotal("ae67d0d09984da22e86e5df95e4a9c183b9db2ae3b52a07a37e556b3161074c5") #Initializing the VirusTotal API Key

def banner():
	print "\n\n"
	print "\t\t     _  ___  _   _ _   _ "
	print "\t\t    | |/ _ \| | | | \ | |"
	print "\t\t _  | | | | | |_| |  \| |"
	print "\t\t| |_| | |_| |  _  | |\  |"
	print "\t\t \___/ \___/|_| |_|_| \_|"
	print "\t\t                         "
	print "\t\tAutomated VirusTotal-powered Malware Scanner\n\n"
	print "[#] Developed By John Chakauya"

banner()

def malware_scan(scan_file):

	scan_report = scanner.scan(scan_file) #Scanning the user entered file

	if scan_report.done:
		print(scan_report)

	print "\nFULL SCAN REPORT:"
	for av, malware in scan_report:                    #Output full scan report
		print "- %s (%s, %s):\t%s" % (av[0], av[1], av[2], malware, )

	        print

	print("\n*** REPORT SUMMARY ***:")
	print("VirusTotal Scan ID: " + str(scan_report.scan_id) + "\nAntiviruses Total: " + str(scan_report.total) + "\nAntivirus Positives: " + str(scan_report.positives))

print("\n**** Automated VirusTotal-powered Malware Scanner by John Chakauya ****\n")

#Prompt user to enter the the file to be scanned using VirusTotal, the file can be given using file path or hash value (MD5, SHA-1 or SHA-256)
file = raw_input("Enter the file path and name of the file to be scanned e.g /root/virus.exe, or file hash value(MD5, SHA-1 or SHA-256)..Enter blank to exit\n")

if(file != ""):
	#Invoking function to scan the entered file
	malware_scan(file)

while(file != ""):
	print("\n**** Automated VirusTotal-powered Malware Scanner by John Chakauya ****\n")

	#Prompt user to enter the the file to be scanned using VirusTotal, the file can be given using file path or hash value (MD5, SHA-1 or SHA-256)
	file = raw_input("Enter the file path and name of the file to be scanned e.g /root/virus.exe, or file hash value(MD5, SHA-1 or SHA-256)..Enter blank to exit\n")

	if(file != ""):
		#Invoking function to scan the entered file
		malware_scan(file)
